---
title: "Counting"
output: html_document
---

```{r Import data}
source("read_in_data.R")
source("functions.R")
source("dicts.R")
```

```{r Find the total number of deaths}
total_cyc_deaths <- sum(cyclists$status=="dead", na.rm = TRUE)
total_ped_deaths <- sum(pedestrians$status=="dead", na.rm = TRUE)
total_oth_deaths <- sum(others$status=="dead", na.rm = TRUE)

total_deaths <- total_cyc_deaths + total_ped_deaths + total_oth_deaths

# Get the total injuries
# Search for "injury"
total_cyc_injuries <- sum(grepl("injury", cyclists$status, fixed = TRUE), na.rm=TRUE)
total_ped_injuries <- sum(grepl("injury", pedestrians$status, fixed = TRUE), na.rm=TRUE)
total_oth_injuries <- sum(grepl("injury", others$status, fixed = TRUE), na.rm=TRUE)

# get an intersection of these IDs to make sure I'm not double-counting
total_serious_major_injuries <- sum(grepl("serious", c(as.character(pedestrians$status),
                                      as.character(others$status),
                                      as.character(cyclists$status)),
                        fixed = TRUE), na.rm = TRUE) + 
  sum(grepl("major", c(as.character(pedestrians$status),
                                      as.character(others$status),
                                      as.character(cyclists$status)),
                        fixed = TRUE), na.rm = TRUE)

total_crit <- 
  sum(grepl("critical", c(as.character(pedestrians$status),
                                      as.character(others$status),
                                      as.character(cyclists$status)),
                        fixed = TRUE), na.rm = TRUE) + 
  sum("life-threatening injury"== c(as.character(pedestrians$status),
                                    as.character(others$status),
                                    as.character(cyclists$status)),
                        fixed = TRUE, na.rm = TRUE)

total_injuries <- total_cyc_injuries + total_ped_injuries + total_oth_injuries

# Get total incidents
total_incidents <- length(unique(incidents$incident_id))

# Get total victims
# (Some people may be uninjured but still hit)
total_cyc_victims <- nrow(cyclists)
total_ped_victims <- nrow(pedestrians)
total_oth_victims <- nrow(others)

total_victims <- total_cyc_victims + total_ped_victims + total_oth_victims

total_fled <- sum(grepl("fled", vehicles$notes, fixed = TRUE), na.rm = TRUE)
```
